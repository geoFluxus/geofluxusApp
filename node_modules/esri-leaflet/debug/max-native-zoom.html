<!DOCTYPE html>
  <html>
  <head>
    <meta charset=utf-8 />
    <title>Esri Leaflet Debugging Sample</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Load Leaflet -->
    <link rel="stylesheet" href="../node_modules/leaflet/dist/leaflet.css" />
    <script src="../node_modules/leaflet/dist/leaflet-src.js"></script>

    <!-- Load Esri Leaflet from source-->
    <script src="../dist/esri-leaflet-debug.js"></script>

    <style>
      body {
        margin:0;
        padding:0;
      }

      #map {
        position: absolute;
        top:20px;
        bottom:0;
        right:0;left:0;
      }

      #zoomLevel {
        display:inline;
      }

    </style>
  </head>
  <body>

  <span>Zoom Level: </span><div id="zoomLevel">16</div>
  <div id="map"></div>

  <script>
  var map = L.map('map').setView([32.3697585, -85.820615], 16);

  var arcGisWorldStreetMap = L.esri.tiledMapLayer({url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",}).addTo(map);

  // working
  // active, current, retain = true on 10 tiles from level 16
  // so they are not removed by _pruneTiles()

  // not working
  // active propery not present on 10 tiles from level 16

  // not working
  // getTileUrl isn't even called after zoom
  var usaTopoEsri = L.esri.tiledMapLayer({
    url: 'https://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer',
    maxZoom: 17,
    maxNativeZoom: 15
  }).addTo(map);

  var usaTopoLeaflet = L.tileLayer('https://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}', {
    maxZoom:17,
    maxNativeZoom:15,
    });

  var baseLayers = {
    "ArcGIS World Street Map": arcGisWorldStreetMap
  };

  var overlays = {
    "USA TOPO ESRI TILE": usaTopoEsri,
    "USA TOPO Leaflet TILE": usaTopoLeaflet
  };

  L.control.layers(baseLayers, overlays).addTo(map);

  map.on('zoomend', function(e) {
    document.getElementById("zoomLevel").innerHTML = map.getZoom();
  });
  </script>

  </body>
  </html>