<!DOCTYPE html>
  <html>
  <head>
    <meta charset=utf-8 />
    <title>Esri Leaflet Debugging Sample</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Load Leaflet -->
    <link rel="stylesheet" href="../node_modules/leaflet/dist/leaflet.css" />
    <script src="../node_modules/leaflet/dist/leaflet-src.js"></script>

    <!-- Load Esri Leaflet from source-->
    <script src="../dist/esri-leaflet-debug.js"></script>

    <style>
      body {
        margin:0;
        padding:0;
      }

      #map {
        position: absolute;
        top:0;
        bottom:0;
        right:0;left:0;
      }

      .label {
        font-weight: 700;
        text-transform: uppercase;
        text-align: center;
        margin-top: -1em;
      }

      .label div {
        position: relative;
        left: -50%;
        text-shadow: 0px 2px 1px rgba(255,255,255,0.85);
      }
    </style>
  </head>
  <body>

  <div id="map"></div>
  <script>
  // var map = L.map('map').setView([45.526, -122.667], 15);
  //
  //  var basemap = L.esri.basemapLayer('Gray').addTo(map);
  //
  //  var neighborhoods = L.esri.featureLayer({
  //    url: 'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/Neighborhoods_pdx/FeatureServer/0',
  //    style: function() {
  //      return {
  //        color: '#5B7CBA',
  //        weight: 2
  //      };
  //    }
  //  }).addTo(map);
  //
  //  var baseLayers = {
  //    Base: basemap
  //  };
  //  var overlays = {
  //    Neighborhoods: neighborhoods
  //  };
  //
  //  L.control.layers(baseLayers, overlays).addTo(map);
  //
  //  var labels = {};
  //
  //  neighborhoods.on('createfeature', function(e){
  //    var id = e.feature.id;
  //    var feature = neighborhoods.getFeature(id);
  //    var center = feature.getBounds().getCenter();
  //    var label = L.marker(center, {
  //      icon: L.divIcon({
  //        iconSize: null,
  //        className: 'label',
  //        html: '<div>' + e.feature.properties.NAME + '</div>'
  //      })
  //    }).addTo(map);
  //    labels[id] = label;
  //  });
  //
  //  neighborhoods.on('addfeature', function(e){
  //    console.log('Adding feature:', e);
  //    var label = labels[e.feature.id];
  //    if(label){
  //      label.addTo(map);
  //    }
  //  });
  //
  //  neighborhoods.on('removefeature', function(e){
  //    console.log('Removing feature:', e);
  //    var label = labels[e.feature.id];
  //    if(label){
  //      map.removeLayer(label);
  //    }
  //  });

      var map = L.map('map').setView([45.528, -122.680], 11);
      L.esri.basemapLayer("Gray").addTo(map);


      var l = L.esri.featureLayer({
        url: "https://sampleserver6.arcgisonline.com/arcgis/rest/services/911CallsHotspot/MapServer/1",
        where: "1=2"
      }).addTo(map);

      setTimeout(function(){
        // setup handlers
        l.on('createfeature', function(obj){
            console.log('create', obj.feature.properties.OBJECTID);
        }, this);
        l.on('addfeature', function(obj){
            console.log('add', obj.feature.properties.OBJECTID);
        }, this);
        l.on('removefeature', function(obj){
            console.log('remove', obj.feature.properties.OBJECTID);
        }, this);
        // set new where clause
        l.setWhere("OBJECTID = 134");
      }, 5000);
      setTimeout(function(){
        // set new where clause
        l.setWhere("OBJECTID = 13");
      }, 10000);
  </script>

  </body>
  </html>
