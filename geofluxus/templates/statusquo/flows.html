<!--Flows-->

<!--Filter editing-->
<script type="text/template" id="flows-template">
    <div id="filter-content"></div>

    <div class="block accordion" id="dimensionBlock">

        <h4 style="padding-bottom: 0.5em; padding-top: 1em">2. Analyse</h4>

        <div class="card bg-dark" id="dimensionsCard">

            <!-- IF WE NEED COLLAPSE LATER, UNCOMMENT THIS -->
            <div class="card-header" id="card-header-collapse-dimensions">
                <h4 class="mb-1">
                    <button class="btn btn-link collapsingHeaderButton" id="btn-collapse-header-dimensions"
                        data-toggle="collapse" data-target="#collapseDimensionBlock" aria-expanded="true"
                        aria-controls="collapseDimensionBlock">
                        <i class="fa fa-chevron-down pull-right"></i>
                        Define dimensions & granularity
                    </button>
                </h4>

            </div>

            <div id="collapseDimensionBlock" class="collapse show" aria-labelledby="card-header-collapse-dimension"
                 data-parent="#dimensionBlock">

                <div class="card-body">

                    <!-- <div class="row align-items-end border-bottom mb-3 mt-1">
                        <div class="col-md-3 text-center">
                            <label class="dimensionHeaderLabel">Dimension</label>
                        </div>
                        <div class="col-md-4 text-center">
                            <label class="dimensionHeaderLabel">Granularity</label>
                        </div>
                    </div> -->

                    <!-- TIME -->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-time" class="dimensionToggle" id="dim-toggle-time" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-dim="time" data-on="Time"
                                    data-off="Time">
                            </div>
                        </div>
                        <div class="col-md-3" id="gran-toggle-time-col" style="display: none">
                            <div class="checkbox">
                                <input name="gran-toggle-time" id="gran-toggle-time" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Month"
                                    data-off="Year">
                            </div>
                        </div>
                    </div>

                    <!-- Space -->
                    <div class="row align-items-center">
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-space" class="dimensionToggle" id="dim-toggle-space" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-dim="space" data-on="Space"
                                    data-off="Space">
                            </div>
                        </div>
                        <div class="col-md-3" id="gran-toggle-space-col" style="display: none">
                            <select name="dim-space-gran-select" id="dim-space-gran-select" class="form-control form-control-sm selectpicker" data-height="21">
                                <% levels.forEach(function(level) { %>
                                <option value="<%= level.id %>"><%= level.get('name') %></option>
                                <% }) %>
                            </select>
                        </div>

                        <div class="col-md-3" id="origDest-toggle-space-col" style="display: none">
                            <div class="checkbox">
                                <input name="origDest-toggle-space" id="origDest-toggle-space" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Destination"
                                    data-off="Origin">
                            </div>
                        </div>
                    </div>

                    <!-- Economic Activity -->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-economic-activity" class="dimensionToggle" id="dim-toggle-economic-activity" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-dim="economicActivity" data-on="Economic activity"
                                    data-off="Economic activity">
                            </div>
                        </div>
                        <div class="col-md-3" id="gran-econ-activity-col" style="display: none">
                            <div class="checkbox">
                                <input name="gran-toggle-econ-activity" id="gran-toggle-econ-activity" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Activity"
                                    data-off="Activity group">
                            </div>
                        </div>
                        <div class="col-md-3" id="origDest-toggle-econAct-col" style="display: none">
                            <div class="checkbox">
                                <input name="origDest-toggle-econAct" id="origDest-toggle-econAct" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Destination"
                                    data-off="Origin">
                            </div>
                        </div>
                    </div>

                    <!-- Treatment Method -->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-treatment-method" class="dimensionToggle" id="dim-toggle-treatment-method" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-dim="treatmentMethod" data-on="Treatment method"
                                    data-off="Treatment method">
                            </div>
                        </div>
                        <div class="col-md-3" id="gran-treatment-method-col" style="display: none">
                            <div class="checkbox">
                                <input name="gran-toggle-treatment-method" id="gran-toggle-treatment-method" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Treatment method"
                                    data-off="Treatment method group">
                            </div>
                        </div>
                        <div class="col-md-3" id="origDest-toggle-treatment-col" style="display: none">
                            <div class="checkbox">
                                <input name="origDest-toggle-treatment" id="origDest-toggle-treatment" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Destination"
                                    data-off="Origin">
                            </div>
                        </div>
                    </div>

                    <!-- Material -->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-material" class="dimensionToggle" id="dim-toggle-material" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-dim="material" data-on="Material"
                                    data-off="Material">
                            </div>
                        </div>
                        <div class="col-md-9" id="gran-material-col" style="display: none">
                            <!-- <div class="checkbox">
                                <input name="gran-toggle-treatment-method" id="gran-toggle-treatment-method" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Treatment method"
                                    data-off="Treatment method group">
                            </div> -->

                            <div class="btn-group btn-group-toggle" id="gran-radio-material" data-toggle="buttons" style="width: 100%; max-width: 30rem">
                                <label class="btn btn-sm btn-primary gran-radio-material-label active" data-ewc="ewc2">
                                    <input type="radio" class="gran-radio-material-input" id="gran-radio-material-ewc2" checked>Chapter
                                </label>
                                <label class="btn btn-sm btn-primary gran-radio-material-label" data-ewc="ewc4">
                                    <input type="radio" class="gran-radio-material-input" id="gran-radio-material-ewc4">Sub-Chapter
                                </label>
                                <label class="btn btn-sm btn-primary gran-radio-material-label" data-ewc="ewc6">
                                    <input type="radio" class="gran-radio-material-input" id="gran-radio-material-ewc6">Entry
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Logistics -->
                    <!-- <div class="row">
                        <div class="col-md-3">
                            <label for="dim-toggle-logistics" class="dimensionLabel">Logistics</label>
                        </div>
                        <div class="col-md-3">
                            <div class="checkbox">
                                <input name="dim-toggle-logistics" class="dimensionToggle" id="dim-toggle-logistics" type="checkbox"
                                    data-width="100%" data-height="21" data-toggle="toggle" data-on="Selected"
                                    data-off="Aggregate">
                            </div>
                        </div>
                        <div class="col-md-3">

                        </div>
                    </div> -->

                     <!-- Max dimensions -->
                     <div class="row" id="alertMaxDimensionsRow" style="display: none;">
                        <div class="col mt-3 text-center">
                            <div class="alert alert-warning fade show" id="alertMaxDimensions" role="alert">
                                You can select up to <strong><%= maxNumberOfDimensions %> dimensions</strong> at the same time.
                            </div>
                        </div>
                     </div>

                </div>
            </div>

        </div>


        <div class="card bg-dark">

            <div class="card-header" id="card-header-collapse-visualizations">
                <h4 class="mb-1">
                    <button class="btn btn-link collapsingHeaderButton"
                            id="btn-collapse-header-vizualisations"
                            data-toggle="collapse"
                            data-target="#collapseVizualisationBlock"
                            aria-expanded="true"
                            aria-controls="collapseVizualisationBlock">
                        <i class="fa fa-chevron-down pull-right"></i>
                        Choose visualization type
                    </button>
                </h4>

            </div>

            <div id="collapseVizualisationBlock" class="collapse show" aria-labelledby="card-header-collapse-visualizations"
                data-parent="#dimensionBlock">

                <div class="card-body">

                    <div class="row" id="message-container-row">
                        <div class="col">
                            <span style="color: white">Select at least one dimension.</span>
                        </div>
                    </div>

                    <div class="viz-container" style="display: none;">
                        <div class="row" style="width: 100%;">
                            <div class="col d-flex align-items-center mr-auto">
                                <div class="btn-group btn-group-toggle flex-wrap justify-content-center" id="visualization-type" data-toggle="buttons" style="margin: auto">
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="piechart" style="display: none;">
                                        <input type="radio" id="viz-piechart"><span class="span-viz" id="span-viz-piechart">Pie chart</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="treemap" style="display: none;">
                                        <input type="radio" id="viz-treemap"><span class="span-viz" id="span-viz-treemap">Treemap</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="barchart" style="display: none;">
                                        <input type="radio" id="viz-barchart"><span class="span-viz" id="span-viz-barchart">Bar chart</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="lineplot" style="display: none;">
                                        <input type="radio" id="viz-lineplot"><span class="span-viz" id="span-viz-lineplot">Line plot</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="choroplethmap" style="display: none;">
                                        <input type="radio" id="viz-choroplethmap"><span class="span-viz" id="span-viz-choroplethmap">Choropleth map</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="coordinatepointmap" style="display: none;">
                                        <input type="radio" id="viz-coordinatepointmap"><span class="span-viz" id="span-viz-coordinatepointmap">Coordinate point map</span>
                                    </label>

                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="lineplotmultiple" style="display: none;">
                                        <input type="radio" id="viz-lineplotmultiple"><span class="span-viz" id="span-viz-lineplotmultiple">Multiple line plot</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="areachart" style="display: none;">
                                        <input type="radio" id="viz-areachart"><span class="span-viz" id="span-viz-areachart">Stacked area chart</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="stackedbarchart" style="display: none;">
                                        <input type="radio" id="viz-stackedbarchart"><span class="span-viz" id="span-viz-stackedbarchart">Stacked bar chart</span>
                                    </label>

                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="parallelsets" style="display: none;">
                                        <input type="radio" id="viz-parallelsets"><span class="span-viz" id="span-viz-parallelsets">Parallel sets</span>
                                    </label>
                                    <label class="btn btn-sm btn-primary justify-content-center align-items-end viz-selector-button" data-viz="flowmap" style="display: none;">
                                        <input type="radio" id="viz-flowmap"><span class="span-viz" id="span-viz-flowmap">Flow map</span>
                                    </label>

                                </div>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col d-flex">
                                <div class="custom-control custom-checkbox" style="margin: auto;">
                                    <input type="checkbox" class="custom-control-input" id="display-legend">
                                    <label class="custom-control-label" for="display-legend">Display legend</label>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        </div>

        <div class="row mt-3 mb-2 d-flex justify-content-between">

            <button id='reset-dim-viz' class="btn btn-secondary"
                title="Reset all dimension and visualization settings"
                style="width: 10em">Reset
            </button>

            <div style="margin-right: 1rem;">
                <div class="helpIconContainer d-inline-flex align-items-center">
                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Filter & Render"
                    style="float: left;" data-html="true" tabindex="0"
                    data-content="<b>Filter</b> the waste flows according to the filters in Origin, Destination,
                    and Flows, and <b>render</b> the selected visualization based on the chosen dimensions and granularity.">
                    </a>
                </div>
                <button id='apply-filters' class="btn btn-primary"
                    title="Apply the filters and render the selected visualization."
                    style="margin-left: 10px; float: right; width: 10em">Visualize
                </button>
            </div>
         </div>
    </div>


    <!-- template for viewing flows as sankey or map  -->
    <div id="flows-render-template">

         <div class="row">
            <div class="col">
                <div class="viz-wrapper-div piechart-wrapper"></div>
                <div class="viz-wrapper-div barchart-wrapper"></div>
                <div class="viz-wrapper-div lineplot-wrapper"></div>
                <div class="viz-wrapper-div treemap-wrapper"></div>
                <div class="viz-wrapper-div choropleth-wrapper"></div>
                <div class="viz-wrapper-div coordinatepointmap-wrapper"></div>

                <div class="viz-wrapper-div areachart-wrapper"></div>
                <div class="viz-wrapper-div stackedbarchart-wrapper"></div>
            </div>
        </div>

        <!-- <div class="row" style="margin-top: 20px;">
            <div class="col-md-6 min-width-600px">
                <div class="row" style="padding: 0px;">
                    <span class="fa-stack sankey-help-icon-container">
                        <i class="sankey-help-icon-bg fa fa-circle fa-stack-1x"></i>
                        <a class="sankey-help-icon help-icon fas fa-question-circle fa-stack-1x" data-toggle="popover" title="Sankey Diagram" data-html="true" tabindex="0"
                        data-content="This diagram displays the filtered flows and their origins and destinations.
                            Origins and destinations represent groups, activities or actors, depending on the Level selection.
                            The flow direction is from left to right.<br><br>
                            <b>Flow selection</b><br>
                            Tap a flow to display it and the involved actors on the map to the right. Tap it again to unselect it and remove it from the map.
                            <br><br>
                            <b>Controls</b><br>
                            The diagram is zoomable and movable with touch gestures.
                            The crosshair icon resets the zoom and centers the diagram.
                            <br><br>
                            <b>Export</b>
                            <br> You can export your current view as an image by pressing the camera button.
                            To export the flow data as a csv file press the button with the paper icon">
                        </a>
                    </span>

                    <div class="sankey-wrapper" class="noselect">
                        <div class="d3-zoom-controls">
                            <a class="btn square" data-zoom="+0.5"><span class="fa fa-plus"></span></a>
                            <a class="btn square" data-zoom="-0.5"><span class="fa fa-minus"></span></a>
                            <a class="btn square" data-zoom="0"><span class="fa fa-crosshairs"></span></a>
                        </div>
                        <div class="sankeyUtilityButtonContainer">
                            <button class="export-img fas fa-camera btn btn-primary d3-overlay inverted"></button>
                            <button class="export-csv fas fa-file btn btn-primary d3-overlay inverted"></button>
                            <button class="fullscreen-toggle fas fa-expand btn btn-primary d3-overlay inverted"></button>
                        </div> -->
                        <!-- <div style="position: absolute; bottom: 15px; left: 10px;">
                            <button class="select-all fas fa-vector-square btn btn-primary d3-overlay inverted" style="position: relative; float: left; margin-right: 10px; height: 30px;">&nbsp;All</button>
                            <button class="deselect-all fas fa-ban btn btn-primary d3-overlay inverted" style="position: relative; height: 30px;">&nbsp;None</button>
                        </div> -->
                        <!-- <div class="sankey" style="text-align: center;"></div>
                    </div>
                </div>
            </div> -->



            <!-- <div class="col-md-6 bordered min-width-600px">
                <a class="help-icon glyphicon glyphicon-question-sign" data-toggle="popover" title="Sankey Map" style="margin: 15px; position: absolute; z-index:1000;" data-html="true" tabindex="0"
                    data-content="This map displays the selected flows of the sankey diagram to the left on a spatial actor level.
                        The color coding of the basic flows and activities and actors matches the sankey diagram.
                        Tap a flow or actor on the map to display a tooltip with information about it.
                        <br><br>
                        To visualize the flow direction the <i>Animate Flows</i> checkbox has to be activated.">
                </a>
                <div id="flow-map" style="width: 100%; height: 600px;"></div>
            </div> -->

        </div>
    </div>
</script>