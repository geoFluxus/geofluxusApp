<!--Filters-->
<script type="text/template" id="filter-template">
  {% load custom_tags %}
    <div class="block accordion" id="filterBlock">

        <div class="row justify-content-between">
          <h4 class="pb-1 pl-3">Step 1: Filter the waste flows (optional)</h4>            
        </div>

        <div class="card bg-dark">
          <div class="card-header" id="card-header-collapse-general">
            <h4 class="mt-2 ml-3">
              <button 
                class="btn btn-link collapsingHeaderButton" 
                id="btn-collapse-header-origin"
                data-toggle="collapse" 
                data-target="#collapseGeneralBlock" 
                aria-expanded="true"
                aria-controls="collapseGeneralBlock"
                title="">
                <i class="fa fa-chevron-down pull-right"></i>
                  General
              </button>
            </h4>
          </div>

          <div 
            id="collapseGeneralBlock" 
            class="collapse show" 
            aria-labelledby="card-header-collapse-general"
            data-parent="#filterBlock">

            <div class="card-body" style="min-height: 10rem;">            
              <button
                id='view-saved-filters'
                class="btn btn-secondary openSavedFilterModal"
                data-filter-modal-mode="savedMode"
                title="Load saved filter configurations."
                style="margin: 10px; height: 38px; width: 10rem">
                  LOAD FILTERS
              </button>

              <div class="row"
                {% if not request.user|isExpertUser %}
                style="display: none;"
                {% endif %}>
  
                <div class="col-md-3 flows-dataset-select-col">
                  <label for="flows-dataset-select">Data set</label>
                  <div class="labelHelpiconContainer">
                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Data set"
                      data-html="true" tabindex="0" data-content="Select the data set you want to analyse.">
                    </a>
                  </div>
  
                  <select name="flows-dataset-select" id="flows-dataset-select" multiple
                    class="form-control form-control-sm selectpicker" data-size="4"
                    style="resize: vertical;">
                    <option selected value="-1">All (<%= datasets.count %>)</option>
                    <option data-divider="true"></option>
                    <% datasets.forEach(function(dataset){ %>
                    <option value="<%= dataset.id %>"><%= dataset.get('title') %></option>
                    <% }); %>
                  </select>
                </div>
              </div>
  
              <div class="row pb-4">
                <div class="col-md-3">
                  <label for="flows-year-select">Year</label>
                  <div class="labelHelpiconContainer">
                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Year"
                      data-html="true" tabindex="0" data-content="Select the year in which the waste flow has been reported.<br>
                      Upon selecting a Year, the Month filter will become available, containing the months belonging to the selection made in this filter.
                      ">
                    </a>
                  </div>
  
                  <select name="flows-year-select" id="flows-year-select" multiple
                    class="form-control form-control-sm selectpicker" data-size="5"
                    style="resize: vertical;">
                    <option selected value="-1">All (<%= years.count %>)</option>
                    <option data-divider="true"></option>
                    <% years.forEach(function(year){ %>
                      <option value="<%= year.id %>"><%= year.get('code') %></option>
                    <% }); %>
                  </select>
                </div>
  
                <div class="col-md-3" id="flows-monthsCol" style="display: none;">
                  <label for="flows-month-select">Month</label>
                  <div class="labelHelpiconContainer">
                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Month"
                      data-html="true" tabindex="0"
                      data-content="Select the month in which the waste flow has been reported.">
                    </a>
                  </div>
  
                  <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                  <select name="flows-month-select" id="flows-month-select" multiple
                    class="form-control form-control-sm selectpicker" data-live-search="true" data-size="4"
                    style="resize: vertical;">
                  </select>
                </div>
              </div>
            </div>
          </div>

          
        </div>

        <!-- ORIGIN CONTROLS -->
        <div class="card bg-dark">
          <div class="card-header" id="card-header-collapse-origin">
            <h4 class="mb-1">
              <button 
                class="btn btn-link collapsingHeaderButton" 
                id="btn-collapse-header-origin"
                data-toggle="collapse" 
                data-target="#collapseOriginBlock" 
                aria-expanded="true"
                aria-controls="collapseOriginBlock"
                title="The filters related to the Origin of the waste flow.">
                <i class="fa fa-chevron-down pull-right"></i>
                  Origin
              </button>
            </h4>
          </div>

          <div 
            id="collapseOriginBlock" 
            class="collapse show" 
            aria-labelledby="card-header-collapse-origin"
            data-parent="#filterBlock">
            
            <!-- Select Areas -->
            <div class="card-body">
              <div class="row">
                <div class="col-md-10 mt-2">
                  <label for="area-select-button-origin">Limit the <strong>origin</strong> of the waste flows
                    to geographic areas:
                  </label>

                  <div class="d-block">
                    <button 
                      id="area-select-button-origin" 
                      class="btn btn-sm btn-primary area-select-button"
                      data-width="100%" 
                      style="width: 13em" 
                      data-area-select-block="origin">
                        Select areas
                    </button>

                    <div class="d-inline buttonHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover"
                        title="Select areas" 
                        data-html="true" 
                        tabindex="0"
                        data-content="Clicking the <b>Select areas</b> button opens a dialog in which you can select one or more geographic areas.<br> The selected areas will be used to filter the waste flows based on the coordinates of the Origin of the waste flow.">
                      </a>
                    </div>
                  </div>
                </div>
              </div>

              <div class='row areaSelections-origin' style="display: none;">
                <div class="col-md-4">
                  <textarea 
                    class="form-control-sm textarea-autosize selections"
                    id="areaSelections-Textarea-origin" 
                    style="width: 100% !important; display: inline-block"
                    type="text" 
                    readonly>
                  </textarea>

                  <button 
                    id="clear-origin-areas-button" 
                    class="btn btn-sm btn-primary clear-areas-button"
                    title="Clear the selected areas." 
                    data-area-clear-button="origin">
                      <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>

              <div class="row mt-2 areaSelections-origin" style="display: none;">
                <div class="col">
                  <div style="display: block;">
                    <label style="display: inline-block;">The origin of the flows must be</label>
                    <div class="checkbox in-or-out-container">
                      <input 
                        name="in-or-out-origin" 
                        id="origin-area-in-or-out" 
                        type="checkbox"
                        data-height="24" 
                        data-toggle="toggle" 
                        data-on="outside" 
                        data-off="within"
                        class="in-out-toggle bootstrapToggle">
                      <label style="display: inline-block;">the selected area(s).</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Select Activity group -->
              {% if not request.user|isDemoUser %}
                <div class="row origin-production" style="display: none;">
                  <div class="col-md-6">
                    <label for="origin-activitygroup-select">Activity group</label>                    

                    <div class="row" style="padding: 0; margin-right: 0px">
                      <div class="col-md-8">
                        <select name="origin-activitygroup-select" id="origin-activitygroup-select" multiple
                          class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                          style="resize: vertical;">
                          <option selected value="-1">All (<%= activitygroups.count %>)</option>
                          <option data-divider="true"></option>
                          <% activitygroups.forEach(function(activity){ %>
                            <option value="<%= activity.id %>">
                              <%= activity.get('code') %>. <%= activity.get('name')[0].toUpperCase() + activity.get('name').slice(1).toLowerCase() %>
                            </option>
                          <% }); %>
                        </select>
                      </div>
                      <div class="col-md-1">
                        <div class="labelHelpiconContainer">
                          <a 
                            class="help-icon fas fa-question-circle" 
                            data-toggle="popover" 
                            title="Activity group"
                            data-html="true" 
                            tabindex="0" 
                            data-content="
                              <span>The Activity group indicates the economic activity of the Origin of the waste flow.</span>
                              <br>
                              <span>This classification is based on the Statistical Classification of Economic Activities in the European Community,
                              also known as NACE Rev. 2. The full list of entries can be consulted <a href='https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_NOM_DTL&StrNom=NACE_REV2&StrLanguageCode=EN&IntPcKey=&StrLayoutCode=HIERARCHIC'>here</a>.</span>
                              <br>
                              <span>This filter also contains four additional custom entries:</span>
                              <ul>
                                  <li>V - Onbekend</li>
                                  <li>WT - Unknown waste treatment</li>
                                  <li>WU - Unknown</li>
                                  <li>X - Route inzameling</li>
                              </ul>
                              <span>Upon selecting an Activity group, the Activity filter will become available, containing the Activities belonging to the selection made in this filter.</span>
                              ">
                          </a>
                        </div>
                      </div>
                    </div>                    
                  </div>

                  <div class="col-md-6" id="origin-activitiesCol" style="display: none">
                    <label for="origin-activity-select">Activity</label>
                    
                    <div class="row" style="padding: 0">
                      <!-- <div class="col" style="padding: 0; margin: 0">
                        <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                      </div> -->
                      <div class="col-md-6">
                        <select
                          id="origin-activity-select"
                          class="form-control form-control-sm selectpicker"
                          name="origin-activity-select"
                          multiple
                          data-live-search="true"
                          data-dropup-auto="false"
                          data-size="6"
                          style="resize: vertical;">
                        </select>
                      </div>
                      <div class="col-md-1">
                        <div class="labelHelpiconContainer">
                          <a 
                            class="help-icon fas fa-question-circle" 
                            data-toggle="popover" 
                            title="Activity"
                            data-html="true" 
                            tabindex="0" 
                            data-content="
                              <span>The Activity indicates the economic activity of the Origin of the waste flow on the most detailed level.
                              This filter contains the Activities belonging to the selection made in the Activity group filter.</span>
                              <br>
                              <span>This classification is based on the Statistical Classification of Economic Activities in the European Community,
                              also known as NACE Rev. 2. The full list of entries can be consulted <a href='https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_NOM_DTL_LINEAR&StrNom=NACE_REV2&StrLanguageCode=EN'>here</a>.</span>
                              <br>
                              <span>This filter also contains several additional custom entries belonging to the custom Activity groups.</span>
                              ">
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}

              
              
              <div class="row">
                <!-- Select specific companies -->
                {% if not request.user|isDemoUser %}
                  <div class="col-md-6 origin-actor-select-col">
                    <label for="origin-actor-select">Select specific <strong>companies</strong>:</label>
                    <div class="row" style="padding: 0">
                      <div class="col-md-8">
                        <select name="origin-actor-select" id="origin-actor-select" multiple
                          class="form-control form-control-sm" data-live-search="true" data-size="6"
                          style="resize: vertical;">
                        </select>
                      </div>
                      <div class="col-md-1" style="padding: 0">
                        <div class="labelHelpiconContainer" style="padding: 0">
                          <a 
                            class="help-icon fas fa-question-circle" 
                            data-toggle="popover" 
                            title="Companies"
                            data-html="true" 
                            tabindex="0" 
                            data-content="Help content here">
                          </a>
                        </div>
                      </div>
                    </div>
                    
                  </div>
                {% endif %}

                <!-- Collected en Route -->
                <div class="col-md-6">
                  <label for="flows-route-select">Collected en route</label>
                  <div class="row" style="padding: 0">
                    <div class="col-md-5">
                      <select 
                        name="flows-route-select" 
                        id="flows-route-select"
                        class="form-control form-control-sm selectpicker">
                          <option value='both'>Ignore</option>
                          <option value='no'>Not route</option>
                          <option value='yes'>Route</option>
                      </select>
                    </div>
                    <div class="col-md-1" style="padding: 0">
                      <div class="labelHelpiconContainer" style="padding: 0">
                        <a 
                          class="help-icon fas fa-question-circle" 
                          data-toggle="popover" 
                          title="Route"
                          data-html="true" 
                          tabindex="0" 
                          data-content="The Route property indicates whether a waste collection company has collected the same type of waste
                            from multiple different producers of waste. During the waste collection process, the waste from
                            all sources is combined.
                            <br>
                            An example would be municipal waste collection in which the waste from every building is collected by a truck.
                          ">
                        </a>
                      </div>
                    </div>
                    
                    
                  </div>                
                </div>
              </div>

              <!-- Origin Role -->
              <div class="row mt-3" style="display: none;">
                <div class="col-md-12">
                  <label for="origin-role-radio">Origin role</label>
                  <div>
                    <div 
                      class="btn-group btn-group-toggle" 
                      id="origin-role-radio" 
                      data-toggle="buttons"
                      style="width: 30rem;">

                      <label class="btn btn-default origin-role" style="width: 40%;" role="production">
                        <input type="radio" id="origin-role-radio-production">Waste production
                      </label>
                      <label class="btn btn-default origin-role active" style="width: 20%;" role="both">
                        <input type="radio" id="origin-role-radio-both">Both
                      </label>
                      <label class="btn btn-default origin-role" style="width: 40%;" role="treatment">
                        <input type="radio" id="origin-role-radio-treatment">Waste treatment
                      </label>
                    </div>

                    <div class="d-inline buttonHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover"
                        title="Origin role" 
                        data-html="true" 
                        tabindex="0"
                        data-content="Choose the role of the Origin of the waste flow: waste production, waste treatment, or both.<br>
                          If you select waste production, the filters for economic activities will appear.
                          If you choose waste treatment, the filters for the different waste treatment methods will become available.">
                      </a>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row origin-treatment" style="display: none;">
                <div class="col-md-4">
                  <label for="origin-processgroup-select">Treatment method group</label>
                  <div class="labelHelpiconContainer">
                    <a 
                      class="help-icon fas fa-question-circle" 
                      data-toggle="popover"
                      title="Treatment method group" 
                      data-html="true" 
                      tabindex="0" 
                      data-content="
                        <span>The Treatment method group indicates the general treatment method group used by the Origin of the flows.</span>
                        <br>
                        <span>This classification is based on the classification system of the Dutch government agency 'Landelijk Meldpunt Afvalstoffen'.
                        The full list of entries can be consulted <a href='https://www.lma.nl/faq/nummers-codes/verwerkingsmethode/'>here</a>.</span>
                        <br>
                        <span>Upon selecting a Treatment method group, the Treatment method filter will become available, containing the Treatment methods belonging to the selection made in this filter.</span>
                        ">
                    </a>
                  </div>

                  <select name="origin-processgroup-select" id="origin-processgroup-select" multiple
                    class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                    style="resize: vertical;">
                    <option selected value="-1">All (<%= processgroups.count %>)</option>
                    <option data-divider="true"></option>
                    <% processgroups.forEach(function(process){ %>
                      <option value="<%= process.id %>">
                        <%= process.get('name')[0].toUpperCase() + process.get('name').slice(1).toLowerCase() %>
                      </option>
                    <% }); %>
                  </select>
                </div>

                <div class="col-md-4" id="origin-processesCol" style="display: none;">
                  <label for="origin-process-select">Treatment method</label>
                  <div class="labelHelpiconContainer">
                    <a 
                      class="help-icon fas fa-question-circle" 
                      data-toggle="popover"
                      title="Treatment method" 
                      data-html="true" 
                      tabindex="0" 
                      data-content="
                        <span>The Treatment method indicates the specific treatment method used by the Origin of the flows.</span>
                        <br>
                        <span>This classification is based on the classification system of the Dutch government agency 'Landelijk Meldpunt Afvalstoffen'.
                        The full list of entries can be consulted <a href='https://www.lma.nl/faq/nummers-codes/verwerkingsmethode/'>here</a>.</span>
                        ">
                    </a>
                  </div>

                  <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                  <select name="origin-process-select" id="origin-process-select" multiple
                    class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                    style="resize: vertical;">
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- DESTINATION CONTROLS -->
        <div class="card bg-dark">
          <div class="card-header" id="card-header-collapse-destination">
            <h4 class="mb-1">
              <button 
                class="btn btn-link collapsed collapsingHeaderButton" 
                id="btn-collapse-header-destination"
                data-toggle="collapse" 
                data-target="#collapseDestinationBlock" 
                aria-expanded="false"
                aria-controls="collapseDestinationBlock"
                title="The filters related to the Destination of the waste flow.">
                  <i class="fa fa-chevron-down pull-right"></i>
                  Destination
              </button>
            </h4>
          </div>

          <div 
            id="collapseDestinationBlock" 
            class="collapse" 
            aria-labelledby="card-header-collapse-destination"
            data-parent="#filterBlock">
              <div class="card-body">

                <div class="row">
                  <div class="col-md-10">
                    <label for="area-select-button-destination">Limit the <strong>destination</strong> of the
                      waste flows to geographic areas:
                    </label>

                    <div class="d-block">
                      <button id="area-select-button-destination"
                        class="btn btn-sm btn-primary area-select-button" data-width="100%"
                        style="width: 13em" data-area-select-block="destination">Select areas
                      </button>

                      <div class="d-inline buttonHelpiconContainer">
                        <a 
                          class="help-icon fas fa-question-circle" 
                          data-toggle="popover"
                          title="Select areas" 
                          data-html="true" 
                          tabindex="0"
                          data-content="Clicking the <b>Select areas</b> button opens a dialog in which you can select one or more geographic areas.<br> The selected areas will be used to filter the waste flows based on the coordinates of the Destination of the waste flow.">
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                <div class='row areaSelections-destination' style="display: none;">
                  <div class="col-md-4">
                    <textarea 
                      class="form-control-sm textarea-autosize selections"
                      id="areaSelections-Textarea-destination"
                      style="width: 100% !important; display: inline-block" 
                      type="text" 
                      readonly>
                    </textarea>

                    <button 
                      id="clear-destination-areas-button"
                      class="btn btn-sm btn-primary clear-areas-button" 
                      data-area-clear-button="destination"
                      title="Clear the selected areas.">
                        <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>

                <div class="row mt-2 areaSelections-destination" style="display: none;">
                  <div class="col">
                    <div style="display: block;">
                      <label style="display: inline-block;">The destination of the flows must be</label>
                      <div class="checkbox in-or-out-container">
                        <input 
                          name="in-or-out-destination" 
                          id="destination-area-in-or-out" 
                          type="checkbox"
                          data-height="24" 
                          data-toggle="toggle" 
                          data-on="outside" 
                          data-off="within"
                          class="in-out-toggle bootstrapToggle">
                        <label style="display: inline-block;">the selected area(s).</label>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row mt-3" style="display: none;">
                  <div class="col-md-12">
                    <label for="destination-role-radio">Destination role</label>

                    <div>
                      <div 
                        class="btn-group btn-group-toggle" 
                        id="destination-role-radio"
                        data-toggle="buttons" 
                        style="width: 30rem;">

                        <label class="btn btn-default destination-role" style="width: 40%;" role="production">
                          <input type="radio" id="destination-role-radio-production" checked>Waste production
                        </label>
                        <label class="btn btn-default destination-role active" style="width: 20%;" role="both">
                          <input type="radio" id="destination-role-radio-both">Both
                        </label>
                        <label class="btn btn-default destination-role" style="width: 40%;" role="treatment">
                          <input type="radio" id="destination-role-radio-treatment">Waste treatment
                        </label>
                      </div>

                      <div class="d-inline buttonHelpiconContainer">
                        <a 
                          class="help-icon fas fa-question-circle" 
                          data-toggle="popover"
                          title="Origin role" 
                          data-html="true" 
                          tabindex="0"
                          data-content="Choose the role of the Destination of the waste flow: waste production, waste treatment, or both.<br>
                            If you select waste production, the filters for economic activities will appear.
                            If you choose waste treatment, the filters for the different waste treatment methods will become available.">
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                {% if not request.user|isDemoUser %}
                <div class="row destination-production" style="display: none;">
                  <div class="col-md-4">
                    <label for="destination-activitygroup-select">Activity group</label>
                    <div class="labelHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover" 
                        title="Activity group"
                        data-html="true" 
                        tabindex="0" 
                        data-content="
                          <span>The Activity group indicates the economic activity of the Destination of the waste flow.</span>
                          <br>
                          <span>This classification is based on the Statistical Classification of Economic Activities in the European Community,
                          also known as NACE Rev. 2. The full list of entries can be consulted <a href='https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_NOM_DTL&StrNom=NACE_REV2&StrLanguageCode=EN&IntPcKey=&StrLayoutCode=HIERARCHIC'>here</a>.</span>
                          <br>
                          <span>This filter also contains four additional custom entries:</span>
                          <ul>
                            <li>V - Onbekend</li>
                            <li>WT - Unknown waste treatment</li>
                            <li>WU - Unknown</li>
                            <li>X - Route inzameling</li>
                          </ul>
                          <span>Upon selecting an Activity group, the Activity filter will become available, containing the Activities belonging to the selection made in this filter.</span>
                          ">
                      </a>
                    </div>


                      <select 
                        id="destination-activitygroup-select" 
                        name="destination-activitygroup-select"
                        multiple class="form-control form-control-sm selectpicker" 
                        data-live-search="true"
                        data-dropup-auto="false" 
                        data-size="6" 
                        style="resize: vertical;">
                          <option selected value="-1">All (<%= activitygroups.count %>)</option>
                          <option data-divider="true"></option>
                          <% activitygroups.forEach(function(activitygroup){ %>
                            <option value="<%= activitygroup.id %>"><%=(activitygroup.get('code'))%>. <%= activitygroup.get('name')[0].toUpperCase() + activitygroup.get('name').slice(1).toLowerCase() %>
                            </option>
                          <% }); %>
                      </select>
                  </div>

                  <div class="col-md-4" id="destination-activitiesCol" style="display: none">
                    <label for="destination-activity-select">Activity</label>
                    <div class="labelHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover" 
                        title="Activity"
                        data-html="true" 
                        tabindex="0" 
                        data-content="
                          <span>The Activity indicates the economic activity of the Destination of the waste flow  on the most detailed level.
                          This filter contains the Activities belonging to the selection made in the Activity group filter.</span>
                          <br>
                          <span>This classification is based on the Statistical Classification of Economic Activities in the European Community,
                          also known as NACE Rev. 2. The full list of entries can be consulted <a href='https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_NOM_DTL_LINEAR&StrNom=NACE_REV2&StrLanguageCode=EN'>here</a>.</span>
                          <br>
                          <span>This filter also contains several additional custom entries belonging to the custom Activity groups.</span>
                          ">
                      </a>
                    </div>

                    <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                    <select 
                      id="destination-activity-select" 
                      name="destination-activity-select" 
                      multiple
                      class="form-control form-control-sm selectpicker" 
                      data-live-search="true"
                      data-dropup-auto="false" 
                      data-size="6" 
                      style="resize: vertical;">
                    </select>
                  </div>
                </div>
                {% endif %}

                <!-- Treatment Method -->
                <div class="row destination-treatment" style="display: none;">
                  <div class="col-md-4">                          
                    <label for="destination-processgroup-select">Treatment method group</label>
                    <div class="labelHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover"
                        title="Treatment method group" 
                        data-html="true" 
                        tabindex="0" 
                        data-content="
                          <span>The Treatment method group indicates the general treatment method group used by the Destination of the flows.</span>
                          <br>
                          <span>This classification is based on the classification system of the Dutch government agency 'Landelijk Meldpunt Afvalstoffen'.
                          The full list of entries can be consulted <a href='https://www.lma.nl/faq/nummers-codes/verwerkingsmethode/'>here</a>.</span>
                          <br>
                          <span>Upon selecting a Treatment method group, the Treatment method filter will become available, containing the Treatment methods belonging to the selection made in this filter.</span>
                          ">
                      </a>
                    </div>

                    <select 
                      name="destination-processgroup-select" 
                      id="destination-processgroup-select" 
                      multiple
                      class="form-control form-control-sm selectpicker" 
                      data-live-search="true" 
                      data-size="6"
                      style="resize: vertical;">
                      <option selected value="-1">All (<%= processgroups.count %>)</option>
                      <option data-divider="true"></option>
                      <% processgroups.forEach(function(process){ %>
                        <option value="<%= process.id %>"><%= process.get('name')[0].toUpperCase() + process.get('name').slice(1).toLowerCase() %>
                        </option>
                      <% }); %>
                    </select>
                  </div>

                  <div class="col-md-4" id="destination-processesCol" style="display: none;">

                    <label for="destination-process-select">Treatment method</label>
                    <div class="labelHelpiconContainer">
                      <a 
                        class="help-icon fas fa-question-circle" 
                        data-toggle="popover"
                        title="Treatment method" 
                        data-html="true" 
                        tabindex="0" 
                        data-content="
                          <span>The Treatment method indicates the specific treatment method used by the Destination of the flows.</span>
                          <br>
                          <span>This classification is based on the classification system of the Dutch government agency 'Landelijk Meldpunt Afvalstoffen'.
                          The full list of entries can be consulted <a href='https://www.lma.nl/faq/nummers-codes/verwerkingsmethode/'>here</a>.</span>
                          ">
                      </a>
                    </div>

                    <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                    <select 
                      name="destination-process-select" 
                      id="destination-process-select"
                        multiple
                      class="form-control form-control-sm selectpicker" 
                      data-live-search="true" 
                      data-size="6"
                      style="resize: vertical;">
                    </select>
                  </div>
                </div>

                <!-- Select Companies -->
                {% if not request.user|isDemoUser %}
                  <div class="row">
                    <div class="col-md-4 destination-actor-select-col">
                      <label for="destination-actor-select">Select specific <strong>companies</strong>:</label>
                      <select 
                        name="destination-actor-select" 
                        id="destination-actor-select" 
                        multiple
                        class="form-control form-control-sm selectpicker" 
                        data-live-search="true" 
                        data-size="6"
                        style="resize: vertical;">
                      </select>
                    </div>
                  </div>
                {% endif %}
              </div>
          </div>
        </div>

        <!-- FLOWS CONTROLS -->
        <div class="card bg-dark"
            style="border-bottom-left-radius: 30px !important; border-bottom-right-radius: 30px !important">
            <div class="card-header" id="card-header-collapse-flows">
                <h4 class="mb-1">
                    <button class="btn btn-link collapsed collapsingHeaderButton" id="btn-collapse-header-flows"
                        data-toggle="collapse" data-target="#collapseFlowsBlock" aria-expanded="false"
                        aria-controls="collapseFlowsBlock"
                        title="The filters related to the properties of the waste flow itself.">
                        <i class="fa fa-chevron-down pull-right"></i>
                        Flows
                    </button>
                </h4>
            </div>

            <div id="collapseFlowsBlock" class="collapse" aria-labelledby="card-header-collapse-flows"
                data-parent="#filterBlock">
                <div class="card-body">

                    <h5 class="subtitle">Geographical</h5>

                    <div class="row">
                        <div class="col-md-10">
                            <label style="width: 450px" for="area-select-button-flows">Select area(s) through which
                                the flows must pass:</label>

                            <div class="d-block">
                                <button id="area-select-button-flows" class="btn btn-sm btn-primary area-select-button"
                                    data-width="100%" style="width: 13em" data-area-select-block="flows">Select areas
                                </button>

                                <div class="d-inline buttonHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover"
                                        title="Select areas" data-html="true" tabindex="0"
                                        data-content="Clicking the <b>Select areas</b> button opens a dialog in which you can select one or more geographic areas.<br> The selected areas will be used to filter the waste flows based on the <b>estimated route</b> of the waste transport.">
                                    </a>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="row areaSelections-flows" style="display: none;">
                        <div class="col-md-4">

                            <textarea class="form-control-sm textarea-autosize selections"
                                id="areaSelections-Textarea-flows" style="width: 100% !important; display: inline-block"
                                type="text" readonly></textarea>
                            <button id="clear-flows-areas-button" class="btn btn-sm btn-primary clear-areas-button"
                                data-area-clear-button="flows">
                                <i class="fas fa-times"></i>
                            </button>

                        </div>
                    </div>

                    <h5 class="subtitle">European Waste Catalogue Codes (EuralCode)</h5>

                    <div class="row">
                        <div class="col-md-3">
                            <label for="flows-hazardous-select">Hazardous</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Hazardous"
                                    data-html="true" tabindex="0" data-content="<span>The European Waste Catalogue (EWC) Code of a waste flow contains an asterisk (*) to indicate whether the waste is considered to be hazardous.
                                    This filter allows you to include or exclude flows containing hazardous materials. By default, this filter ignores this property and returns both options.</span>
                                    <span>The full list of EWC Entries, including the hazardous entries, can be consulted <a href='https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52018XC0409(01)&from=EN#d1e749-21-1-table'>here</a></span>
                                    ">
                                </a>
                            </div>
                            <select name="flows-hazardous-select" id="flows-hazardous-select"
                                class="form-control form-control-sm selectpicker">
                                <option value='both'>Ignore</option>
                                <option value='no'>Not hazardous</option>
                                <option value='yes'>Hazardous</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3" id="flows-wastes02Col">

                            <label for="flows-waste02-select">Chapter</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="EWC Chapter"
                                    data-html="true" tabindex="0" data-content="<span>Filter the waste flows by the European Waste Catalogue (EWC) code, also known as Euralcode.
                                    EWC-codes exist in three levels: Chapters, Sub-Chapters, and Entries.</span>
                                    <br>
                                    <span>The full list of entries can be consulted <a href='https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52018XC0409(01)&from=EN#d1e749-21-1-table'>here</a>.</span>
                                    <br>
                                    <span>Upon selecting an EWC Chapter, the Sub-Chapter filter will become available, containing the Sub-Chapters belonging to the selection made in this filter.</span>
                                    ">
                                </a>
                            </div>

                            <select name="flows-waste02-select" id="flows-waste02-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= wastes02.count %>)</option>
                                <option data-divider="true"></option>
                                <% wastes02.forEach(function(waste){ %>
                                <option value="<%= waste.id %>"><%= waste.get('ewc_code') + ". "%>
                                    <%= waste.get('ewc_name')[0].toUpperCase() + waste.get('ewc_name').slice(1).toLowerCase() %>
                                </option>
                                <% }); %>
                            </select>
                        </div>

                        <div class="col-md-3" id="flows-wastes04Col" style="display: none;">

                            <label for="flows-waste04-select">Sub-Chapter</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover"
                                    title="EWC Sub-Chapter" data-html="true" tabindex="0" data-content="<span>Filter the waste flows by the European Waste Catalogue (EWC) code, also known as Euralcode.
                                    EWC-codes exist in three levels: Chapters, Sub-Chapters, and Entries.</span>
                                    <br>
                                    <span>The full list of entries can be consulted <a href='https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52018XC0409(01)&from=EN#d1e749-21-1-table'>here</a>.</span>
                                    <br>
                                    <span>Upon selecting an EWC Sub-Chapter, the EWC Entry filter will become available, containing the EWC Entries belonging to the selection made in this filter.</span>
                                    ">
                                </a>
                            </div>

                            <i class="fas fa-angle-double-right filterDoubleChevron"></i>
                            <select name="flows-waste04-select" id="flows-waste04-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                            </select>
                        </div>

                        <div class="col-md-3" id="flows-wastes06Col" style="display: none;">

                            <label for="flows-waste06-select" id="flows-waste06-label">EWC Entry</label>
                            <div class="labelHelpiconContainer" id="helpiconWaste06">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="EWC Entry"
                                    data-html="true" tabindex="0" data-content="<span>Filter the waste flows by the European Waste Catalogue (EWC) code, also known as Euralcode.
                                    EWC-codes exist in three levels: Chapters, Sub-Chapters, and Entries.</span>
                                    <br>
                                    <span>The full list of entries can be consulted <a href='https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52018XC0409(01)&from=EN#d1e749-21-1-table'>here</a>.</span>
                                    ">
                                </a>
                            </div>

                            <i class="fas fa-angle-double-right filterDoubleChevron chevronEwc06"></i>
                            <select name="flows-waste06-select" id="flows-waste06-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                            </select>
                        </div>
                    </div>

                    <h5 class="subtitle">GN codes</h5>

                    <div class="row">
                        <div class="col-md-3" id="flows-gncodesCol">

                            <label for="flows-gncode-select">Code</label>
<!--                            <div class="labelHelpiconContainer">-->
<!--                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="EWC Chapter"-->
<!--                                    data-html="true" tabindex="0" data-content="<span>Filter the waste flows by the European Waste Catalogue (EWC) code, also known as Euralcode.-->
<!--                                    EWC-codes exist in three levels: Chapters, Sub-Chapters, and Entries.</span>-->
<!--                                    <br>-->
<!--                                    <span>The full list of entries can be consulted <a href='https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52018XC0409(01)&from=EN#d1e749-21-1-table'>here</a>.</span>-->
<!--                                    <br>-->
<!--                                    <span>Upon selecting an EWC Chapter, the Sub-Chapter filter will become available, containing the Sub-Chapters belonging to the selection made in this filter.</span>-->
<!--                                    ">-->
<!--                                </a>-->
<!--                            </div>-->

                            <select name="flows-gncode-select" id="flows-gncode-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= gncodes.count %>)</option>
                                <option data-divider="true"></option>
                                <% gncodes.forEach(function(gncode){ %>
                                <option value="<%= gncode.id %>"><%= gncode.get('code') %>
                                    <%= gncode.get('name') %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                    </div>

                    <h5 class="subtitle">Contents</h5>
                    <div class="row">
                        <div class="col-md-3">
                            <label for="flows-material-select">Materials</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Materials"
                                    data-html="true" tabindex="0" data-content="Filter the flows based on their material content.
                                    Selecting one or more materials will return all flows containing the selected material(s),
                                    meaning that selecting sand will return all flows containing only sand, as well as flows
                                    consisting of sand mixed with other materials. Use the Mixed filter on the Not mixed setting
                                    to only include non-mixed material flows.">
                                </a>
                            </div>
                            <select id="flows-material-select" name="flows-material-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= materials.length %>)</option>
                                <option data-divider="true"></option>
                                <% materials.forEach(function(material){ %>
                                <option value="<%= material.id %>"><%= '&emsp;'.repeat(material.get('level')) + material.get('name') %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="flows-agenda-select">Agendas</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Materials"
                                    data-html="true" tabindex="0" data-content="Filter the flows based on their material content.
                                    Selecting one or more materials will return all flows containing the selected material(s),
                                    meaning that selecting sand will return all flows containing only sand, as well as flows
                                    consisting of sand mixed with other materials. Use the Mixed filter on the Not mixed setting
                                    to only include non-mixed material flows.">
                                </a>
                            </div>
                            <select id="flows-agenda-select" name="flows-agenda-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= agendas.length %>)</option>
                                <option data-divider="true"></option>
                                <% agendas.forEach(function(agenda){ %>
                                <option value="<%= agenda.id %>"><%= agenda.get('name') %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="flows-industry-select">Industries</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Materials"
                                    data-html="true" tabindex="0" data-content="Filter the flows based on their material content.
                                    Selecting one or more materials will return all flows containing the selected material(s),
                                    meaning that selecting sand will return all flows containing only sand, as well as flows
                                    consisting of sand mixed with other materials. Use the Mixed filter on the Not mixed setting
                                    to only include non-mixed material flows.">
                                </a>
                            </div>
                            <select id="flows-industry-select" name="flows-industry-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= industries.length %>)</option>
                                <option data-divider="true"></option>
                                <% industries.forEach(function(industry){ %>
                                <option value="<%= industry.id %>"><%= industry.get('name') %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="flows-chain-select">Chains</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Materials"
                                    data-html="true" tabindex="0" data-content="Filter the flows based on their material content.
                                    Selecting one or more materials will return all flows containing the selected material(s),
                                    meaning that selecting sand will return all flows containing only sand, as well as flows
                                    consisting of sand mixed with other materials. Use the Mixed filter on the Not mixed setting
                                    to only include non-mixed material flows.">
                                </a>
                            </div>
                            <select id="flows-chain-select" name="flows-chain-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= chains.length %>)</option>
                                <option data-divider="true"></option>
                                <% chains.forEach(function(chain){ %>
                                <option value="<%= chain.id %>"><%= chain.get('name') %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                        {% comment %}
                        <div class="col-md-3">
                            <label>Products</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Products"
                                    data-html="true" tabindex="0" data-content="The Products filter allows for the filtering of materials
                                    which are considered directly reusable.">
                                </a>
                            </div>
                            <select name="flows-product-select" id="flows-product-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= products.count %>)</option>
                                <option data-divider="true"></option>
                                <% products.forEach(function(product){ %>
                                <option value="<%= product.id %>">
                                    <%= product.get('name')[0].toUpperCase() + product.get('name').slice(1) %></option>
                                <% }); %>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label>Composites</label>
                            <div class="labelHelpiconContainer">
                                <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Composites"
                                    data-html="true" tabindex="0" data-content="The Composites filter allows for the filtering of
                                    waste flows consisting of more than two materials that are not directly usable. These flows
                                    will require an additional processing step in order to separate the individual materials
                                    making up the composite.">
                                </a>
                            </div>
                            <select name="flows-composites-select" id="flows-composites-select" multiple
                                class="form-control form-control-sm selectpicker" data-live-search="true" data-size="6"
                                style="resize: vertical;">
                                <option selected value="-1">All (<%= composites.count %>)</option>
                                <option data-divider="true"></option>
                                <% composites.forEach(function(composite){ %>
                                <option value="<%= composite.id %>">
                                    <%= composite.get('name')[0].toUpperCase() + composite.get('name').slice(1) %>
                                </option>
                                <% }); %>
                            </select>
                        </div>
                        {% endcomment %}
                    </div>

                    <div {% if not request.user|isExpertUser %}
                        style="display: none;"
                        {% endif %}>

                        <h5 class="subtitle">Characteristics</h5>
                        <div class="row">
                            <div class="col-md-3">
                                <label for="flows-clean-select">Clean</label>
                                <div class="labelHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Clean"
                                        data-html="true" tabindex="0"
                                        data-content="The Clean filter indicates the extent to which a
                                        flow is expected to be contaminated with another substance. Mono streams are considered
                                        clean streams since they consist of one material and are not contaminated, i.e. clean.">
                                    </a>
                                </div>
                                <select id="flows-clean-select" name="flows-clean-select"
                                    class="form-control form-control-sm selectpicker" multiple style="resize: vertical;">
                                    <option selected value='-1'>Ignore</option>
                                    <option data-divider="true"></option>
                                    <option value='unknown'>Unknown</option>
                                    <option value='no'>Not clean</option>
                                    <option value='yes'>Clean</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="flows-mixed-select">Mixed</label>
                                <div class="labelHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Mixed"
                                        data-html="true" tabindex="0" data-content="The Mixed category indicates whether the flow
                                        contains two or more materials. A mixed flow could consist of two or more clean materials
                                        (masonry and concrete rubble, f.e.), but also two materials of which one is an identified
                                        pollutant (soil containing mineral oil, f.e.). All non-clean flows are by definition mixed,
                                        indicating they contain two or more materials.">
                                    </a>
                                </div>
                                <select id="flows-mixed-select" name="flows-mixed-select"
                                    class="form-control form-control-sm selectpicker" multiple style="resize: vertical;">
                                    <option selected value='-1'>Ignore</option>
                                    <option data-divider="true"></option>
                                    <option value='unknown'>Unknown</option>
                                    <option value='no'>Not mixed</option>
                                    <option value='yes'>Mixed</option>
                                </select>
                            </div>
                            {% comment %}
                            <div class="col-md-3">
                                <label for="flows-direct-select">(An)organic</label>
                                <div class="labelHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Direct use"
                                        data-html="true" tabindex="0" data-content="The Direct use filter indicates whether
                                        a flow is (expected to be) directly reusable in its current form and no additional
                                        processing is required. ">
                                    </a>
                                </div>
                                <select id="flows-direct-select" name="flows-direct-select"
                                    class="form-control form-control-sm selectpicker" multiple style="resize: vertical;">
                                    <option selected value='-1'>Ignore</option>
                                    <option data-divider="true"></option>
                                    <option value='unknown'>Unknown</option>
                                    <option value='no'>Anorganic</option>
                                    <option value='yes'>Organic</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="flows-iscomposite-select">(A)biotic</label>
                                <div class="labelHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Composite"
                                        data-html="true" tabindex="0" data-content="The Composite filter indicates whether a flow contains a
                                        known composite consisting of two or more materials.">
                                    </a>
                                </div>
                                <select id="flows-iscomposite-select" name="flows-iscomposite-select"
                                    class="form-control form-control-sm selectpicker" multiple style="resize: vertical;">
                                    <option selected value='-1'>Ignore</option>
                                    <option data-divider="true"></option>
                                    <option value='unknown'>Unknown</option>
                                    <option value='no'>Biotic</option>
                                    <option value='yes'>Abiotic</option>
                                </select>
                            </div>
                            {% endcomment %}
                        </div>
                        <div class="row pb-4">
                            <div class="col-md-3">
                                <label for="flows-collector-select">Collector</label>
                                <div class="labelHelpiconContainer">
                                    <a class="help-icon fas fa-question-circle" data-toggle="popover" title="Collector"
                                        data-html="true" tabindex="0" data-content="<span>The Collector property indicates whether
                                            a waste collection company has collected the same type of waste from different sources.
                                            In this case, the waste from the different sources has not been combined,
                                            and may only consist of certain types of waste, which can be consulted
                                            <a href='https://www.lma.nl/publish/pages/105041/5-bijlage-a-van-de-regeling2.pdf'>here</a>.</span>
                                        ">
                                    </a>
                                </div>
                                <select name="flows-collector-select" id="flows-collector-select"
                                    class="form-control form-control-sm selectpicker">
                                    <option value='both'>Ignore</option>
                                    <option value='no'>Not collector</option>
                                    <option value='yes'>Collector</option>
                                </select>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

        </div>

        <div class="filter-log-container" style="display: none;">
                <div class="card bg-dark">

                    <div class="card-header">
                        <h4 class="mt-2 ml-3">
                            <button class="btn btn-link collapsingHeaderButton" id="btn-collapse-header-origin"
                                title="">
                                Selected filters
                            </button>

                            <button type="button" class="close text-white closeFilterLog" data-dismiss="modal"><i class="fas fa-times"></i></button>
                        </h4>
                    </div>

                    <div class="card-body">
                        <div class="row pb-4">
                            <div class="col-md-10 filterLog">


                            </div>
                        </div>
                    </div>
                </div>
        </div>



        <div class="row mt-1 d-flex justify-content-start">
            <button id='summarize-filters' class="btn btn-primary"
              title="Summarize the selected filters and check if there is data that matches."
              style="margin-left: 10px; float: right; width: 10em; margin: 0.2rem">
                TEST FILTERS
            </button>
            <button
              id='save-filters'
              class="btn btn-primary openSavedFilterModal"
              data-filter-modal-mode="newMode"
              title="Save the current filter configuration."
              style="height: 38px; width: 10rem; margin: 0.2rem">
                SAVE FILTERS
            </button>
            <button 
              id='reset-filters' 
              class="btn btn-secondary resetButton" 
              style="margin: 0.2rem"
              title="Reset all the filters">
                RESET FILTERS
            </button>
        </div>

    </div>

    <div id="monitor-content" class="analyse-content-container"></div>

    {% comment %}
    <div class="goalContainer">
        <div class="block">
            <h4 class="pb-2 pl-3">Step 2: Define your goal</h4>

            <div class="card bg-dark">
                <div class="row">
                    <div class="col mt-3">
                        <span style="color: white">I want to:</span>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col d-flex align-items-center mr-auto">
                        <div class="btn-group btn-group-toggle flex-wrap justify-content-center" id="radio-group-analyse-mode"
                        data-toggle="buttons" style="margin: auto">

                        <label class="btn btn-sm btn-default justify-content-center align-items-center big-radio-no-image analyse-mode-radio-label" data-mode="monitor">
                            <input type="radio">
                            <span>Monitor waste flows</span>
                        </label>
                        <label class="btn btn-sm btn-default justify-content-center align-items-center big-radio-no-image analyse-mode-radio-label" data-mode="impact">
                            <input type="radio">
                            <span>Perform environmental impact assessment</span>
                        </label>

                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div id="monitor-content" class="analyse-content-container" style="display: inline;"></div>
        <div id="impact-content" class="analyse-content-container" style="display: none;"></div>
    </div>
    {% endcomment %}

  <!--Area selection-->
  <div class="area-filter modal fade" role="dialog"></div>

  <!-- Saved filter modal-->
  <div class="saved-filters modal fade" role="dialog"></div>
</script>

<!-- Saved filter modal-->
<script type="text/template" id="saved-filters-modal-template">
  <div class="modal-dialog modal-lg" style="max-width: 650px">
      <!-- Modal content-->
      <div class="modal-content col-md-12 pt-1">
          <div class="modal-header pt-2 pb-1 ml-2">
              <h4 class="modal-title savedMode">Saved filters</h4>
              <h4 class="modal-title newMode">Save this set of filters</h4>
              <button type="button" class="close" data-dismiss="modal"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body pt-0">

              <form class="newMode needs-validation" novalidate>
                  <div class='row pt-3 pb-0'>
                      <div class="col d-flex mb-1">
                          <div class="form-group w-100 mb-0">
                              <input
                                  type="text"
                                  id="new-filter-name-input"
                                  class="form-control-sm w-100 pl-3"
                                  title="The name of the new saved filter configuration."
                                  placeholder="New filter name"
                                  style="height: 38px; border: none;"
                                  maxlength="255"
                                  required>
                              <div class="invalid-feedback w-100 text-center mt-4">Please fill in a filter name.</div>
                              <div id="filterNameExists" class="invalid-feedback w-100 text-center mt-4" style="display: none;"></div>
                              <small id="newFilterAdded" class="form-text text-white w-100 text-center mt-4" style="display: none;">New filter has been saved!</small>
                          </div>
                          <button
                              id='new-filter-name-btn'
                              class="btn btn-primary"
                              type="submit"
                              title="Save the filter name"
                              style="width: 6.65rem; height: 38px; margin-left: 4px;"
                              >Save</button>
                      </div>
                  </div>
              </form>

              <form class="savedMode needs-validation" novalidate>

                  <div class='row pt-3 savedMode'>
                      <div class="col">
                          <select name="saved-filters-select"
                                  id="saved-filters-select"
                                  class="form-control selectpicker"
                                  style="max-width: 350px;"
                                  data-none-selected-text="No saved filters found.">
                                  <% filters.forEach(function(filter) { %>
                                          <option value="<%= filter.id %>"><%= filter.get('name') %></option>
                                  <% }) %>
                          </select>
                      </div>
                  </div>

                  <div class='row pt-1 pb-2 savedMode'>
                      <div class="col d-flex justify-content-between fourButtons">
                          <button id='delete-filter-config' class="btn btn-secondary w-25" title="Delete the selected filter configuration.">Delete</button>
                          <button id='edit-filter-name' class="btn btn-secondary w-25" title="Rename the selected filter configuration.">Rename</button>
                          <button id='update-filter-config' class="btn btn-secondary w-25" title="Update this filter with the current filter configuration.">Update</button>
                          <button id='load-filter-config' class="btn btn-primary w-25" title="Load the selected filter configuration.">Load</button>
                      </div>
                  </div>

                  <div class='row pt-4 pb-2 mb-3 filterUpdated' style="display: none;">
                      <div class="col d-flex">
                          <small class="text-white w-100 text-center">Filter has been updated!</small>
                      </div>
                  </div>

                  <div class='row pt-4 pb-2 mb-3 filterLoaded' style="display: none;">
                      <div class="col d-flex">
                          <small class="text-white w-100 text-center">Filters have been loaded!</small>
                      </div>
                  </div>

                  <div class='row pt-4 pb-0 mb-2 filterEdit' style="display: none;">
                      <div class="col d-flex">

                          <div class="form-group w-75">
                              <input type="text" class="form-control-sm w-100" maxlength="255" id="update-filter-name" placeholder="Filter name" style="height: 38px; border: none; padding-left: 1rem;" required>
                              <div class="invalid-feedback w-100 text-center mt-4">Please fill in a filter name.</div>
                              <div id="filterNameExists" class="invalid-feedback w-100 text-center mt-4" style="display: none;"></div>
                              <small id="filterNameUpdated" class="form-text text-white w-100 text-center mt-4" style="display: none;">Filter has been renamed!</small>
                          </div>

                          <div class="w-25 d-flex justify-content-between">
                              <button class="btn btn-sm btn-secondary hide-filter-name-button" type="submit">Cancel</button>
                              <button id='save-filter-name'
                                      type="submit"
                                      class="btn btn-primary"
                                      title="Save the filter name">Save</button>
                          </div>

                      </div>
                  </div>
              </form>


          </div>
          <div class="modal-footer">
              <!-- <button type="button" class="btn cancel btn-secondary savedMode" data-dismiss="modal">Cancel</button> -->
              <button class="btn btn-primary confirm" data-dismiss="modal" aria-hidden="true">OK</button>
          </div>
      </div>
  </div>
</script>

<!--Area selection-->
<script type="text/template" id="area-select-modal-template">
  <div class="modal-dialog modal-lg">
      <!-- Modal content-->
      <div class="modal-content col-md-12 pt-1 ml-2">
          <div class="modal-header pt-2 pb-1">
              <h4 class="modal-title">Select areas</h4>
              <button type="button" class="close" data-dismiss="modal"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
              <div class='row pt-1'>
                  <div class="col">
                      <label for="area-level-select" class="input-label">Geographic level:</label>
                      <select name="area-level-select" id="area-level-select" class="form-control form-control-sm selectpicker" style="max-width: 350px;">
                          <% levels.forEach(function(level) { %>
                              <% if (level.get('level') != "1000") %>
                                  <option value="<%= level.id %>"><%= level.get('name') %></option>
                          <% }) %>
                      </select>
                  </div>
              </div>
              <div class='row'>
                  <div class='areaModalMapRow map'></div>
              </div>
              <div class='row pt-0'>
                  <div class="col">
                      <label for="areaSelectionsModalTextarea">Selected areas:</label>
                      <textarea class="form-control-sm textarea-autosize selections" id="areaSelectionsModalTextarea" style="width: 100%" type="text" readonly></textarea>
                  </div>
              </div>
          </div>
          <div class="modal-footer">
              <!-- <button type="button" class="btn cancel btn-secondary" data-dismiss="modal">Cancel</button> -->
              <button class="btn btn-primary confirm" data-dismiss="modal" aria-hidden="true">OK</button>
          </div>
      </div>
  </div>
</script>

<script type="text/template" id="filter-log-template">
  {% load custom_tags %}

    <% if ((log.flows.dataset) || (log.flows.year) || (log.flows.month)) %>
        <h5 class="subtitle mt-0">General</h5>
    <ul>
        <% if (log.flows.dataset != undefined) { %>
            <li><strong>Data sets: </strong><span><%= log.flows.dataset.join(', ') %></span></li>
        <% } %>

        <% if (log.flows.year != undefined) { %>
            <li><strong>Years: </strong><span><%= log.flows.year.join(', ') %></span></li>
        <% } %>

        <% if (log.flows.month != undefined) { %>
            <li><strong>Months: </strong><span><%= log.flows.month.join(', ') %></span></li>
        <% } %>
    </ul>

    <% blocks.forEach(function(block) { %>
        <% if (Object.keys(log[block]).length > 0) %>
            <h5 class="subtitle"><%= block %></h5>
            <ul>
                <% for (const property in log[block]) { %>
                    <% if (!["adminlevel", "inOrOut"].includes(property)) %>
                        <li><strong><%= (property == "selectedAreas") ? filterNameMap.origDest[log[block].inOrOut] :  filterNameMap.origDest[property] %>: </strong><span><%= log[block][property].isArray ? log[block][property].join(', ') : log[block][property] %></span></li>
                <% } %>
            </ul>
    <% }); %>

    <% let { dataset, year, month, ...rest} = log.flows %>
    <% if (Object.keys(rest).length > 0) %>
    <h5 class="subtitle">Flows</h5>
    <ul>
        <% for (const property in log.flows) { %>
            <% if (!["adminlevel", "inOrOut", "dataset", "year", 'month'].includes(property)) %>
                <li><strong><%= (property == "selectedAreas") ? "Pass through these areas" :  filterNameMap.flows[property] %>: </strong><span><%= log.flows[property].isArray ? log.flows[property].join(', ') : log.flows[property] %></span></li>
        <% } %>
    </ul>


</script>
